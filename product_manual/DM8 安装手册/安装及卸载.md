

# 安装及卸载

DM 在各个操作系统下的数据库服务器版本具有相同的内核，本章介绍 DM 在 Windows、Linux(Unix)操作系统下的安装。

注：根据版本的用途，安装 DM 程序后，默认装有一个许可证(License)。如果用户想拥有更多授权的许可证，请向达梦公司申请或购买。

## 2.1 Windows 下 DM 的安装与卸载

### 2.1.1 安装前准备工作

用户在安装 DM 之前需要检查或修改操作系统的配置，以保证 DM 正确安装和运行。

安装程序说明将以 Windows 10 for x86-64 系统为例，由于 Windows 不同操作系统系统图形界面不尽相同，具体步骤及操作请以本机系统为准，具体细节可向系统管理员咨询。

#### 2.1.1.1 检查系统信息

用户在安装 DM 前，需要检查当前操作系统的相关信息，确认 DM 安装程序与当前操作系统匹配，以保证 DM 能够正确安装和运行。用户可以在终端中输入 systeminfo 命令进行查询。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.1-查询系统信息.png)

图2.1查询系统信息

#### 2.1.1.2 检查系统内存与存储空间

1.检查内存

为了保证 DM 的正确安装和运行，要尽量保证操作系统至少 1GB 的可用内存(RAM)。如果可用内存过少，可能导致 DM 安装或启动失败。用户可以通过“任务管理器”查看可用内存。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.2-查看内存.png)

图2.2 查看内存

2.检查存储空间

DM 完全安装需要 1GB 的存储空间，用户需要提前规划好安装目录，预留足够的存储空间。用户在 DM 安装前也应该为数据库实例预留足够的存储空间，规划好数据路径和备份路径。

### 2.1.2 安装 DM

在 Windows 环境下，提供两种安装方式：一是具有交互界面的图形化安装；另一种是非交互式的、通过配置文件进行的静默安装。

#### 2.1.2.1 图形化安装

步骤 1：运行安装程序

用户将 DM 安装光盘放入光驱中，插入光盘后安装程序自动运行或直接双击“setup.exe”安装程序后，程序将检测当前计算机系统是否已经安装其他版本 DM。如果存在其他版本 DM，将弹出提示对话框，如图 2.3 所示。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.3-确认界面.png)

图2.3 确认界面

点击“确定”继续安装，将弹出语言与时区选择对话框。点击“取消”则退出安装。

步骤 2:语言与时区选择

请根据系统配置选择相应语言与时区，点击“确定”按钮继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.4-选择语言与时区.png)

图2.4 选择语言与时区

步骤 3：欢迎页面

点击“开始”按钮继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.5-欢迎界面.png)

图2.5 欢迎界面

步骤 4：许可证协议

在安装和使用 DM 之前，该安装程序需要用户阅读许可协议条款，用户如接受该协议，则选中“接受”，并点击“下一步”继续安装；用户若选中“不接受”，将无法进行安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.6-许可证协议.png)

图2.6 许可证协议

步骤 5：验证 Key 文件

用户点击“浏览”按钮，选取 Key 文件，安装程序将自动验证 Key 文件信息。如果是合法的 Key 文件且在有效期内，用户可以点击“下一步”继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.7-Key文件.png)

图2.7 Key文件

步骤 6：选择安装组件

DM 安装程序提供四种安装方式：“典型安装”、“服务器安装”、“客户端安装”和“自定义安装”，用户可根据实际情况灵活地选择。如下图所示：

典型安装包括：服务器、客户端、驱动、用户手册、数据库服务。

服务器安装包括：服务器、驱动、用户手册、数据库服务。

客户端安装包括：客户端、驱动、用户手册。

自定义安装包括：用户根据需求勾选组件，可以是服务器、客户端、驱动、用户手册、数据库服务中的任意组合。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.8-选择组件.png)

图2.8 选择组件

选择需要安装的 DM 组件，并点击“下一步”继续。

一般地，作为服务器端的机器只需选择“服务器安装”选项，特殊情况下，服务器端的机器也可以作为客户机使用，这时，机器必须安装相应的客户端软件。

步骤 7：选择安装目录

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.9-选择安装目录.png)

图2.9 选择安装目录

DM 默认安装在 %HOMEDRIVE%\dmdbms 目录下，用户可以通过点击“浏览”按钮自定义安装目录。如果用户所指定的目录已经存在，则弹出下图所示警告消息框提示用户该路径已经存在。若确定在指定路径下安装请点击“确定”，则该路径下已经存在的 DM 某些组件，将会被覆盖；否则点击“取消”，返回到上图所示界面，重新选择安装目录。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.10-确认安装目录.png)

图2.10 确认安装目录

说明：安装路径里允许字符的范围是小写字母(a-z)、大写字母(A-Z)、数字(0-9)、下划线(_)、空格( )和中文。

步骤 8：安装前小结

显示用户即将进行的安装的有关信息，例如产品名称、版本信息、安装类型、安装目录、可用空间、可用内存等信息，用户检查无误后点击“安装”按钮进行 DM 的安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.11-安装前小结.png)

图2.11 安装前小结

如果 C:\Windows\system32 目录下已存在配置文件 dm_svc.conf，则弹出下图所示警告消息框提示用户该文件已经存在。若点击“是”，则安装时将生成新的配置文件覆盖原有文件，开始进行 DM 的安装；若点击“否”，则安装时不另外生成新的配置文件，使用原有文件，开始进行 DM 的安装；若点击“取消”，则返回到上图所示界面。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.12-确认是否覆盖配置文件dm_svc.conf.png)

图2.12 确认是否覆盖配置文件dm_svc.conf

步骤 9：安装过程

安装过程。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.13-安装过程.png)

图2.13 安装过程

步骤 10：初始化数据库

如用户在选择安装组件时选中服务器组件，数据库自身安装过程结束时，将会提示是否初始化数据库，如下图所示。若用户未安装服务器组件，安装完成后，点击“完成”将直接退出。点击“取消”将完成安装，关闭对话框。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.14-初始化数据库.png)

图2.14 初始化数据库

若用户选中初始化数据库选项，点击“初始化”将弹出数据库配置工具。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.15-欢迎使用达梦数据库配置助手.png)

图2.15 欢迎使用达梦数据库配置助手

详细初始化步骤请参考[数据库配置工具使用说明](https://eco.dameng.com/document/dm/zh-cn/pm/dm8-tools.html)。

#### 2.1.2.2 静默安装

在某些特殊应用场景，用户可能需要非交互式的、通过配置文件进行 DM 的安装，这种情况我们可以采用以下静默安装的方式。静默安装需要具有管理员权限。

在终端进入到安装程序所在文件夹，执行以下命令：

```
setup.bat -q 配置文件全路径
```

如下图所示：

![图 2.16 静默安装.png](https://eco.dameng.com/eco-file-server/file/eco/preview/20230419103648TM38BCHGPVFPWLLYQ8)

图2.16 静默安装

静默安装配置文件相关说明详见[第 5 章 注意事项](https://eco.dameng.com/document/dm/zh-cn/pm/dm8-appendix.html#%E9%99%84%E5%BD%95%201%20%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9)。

### 2.1.3 卸载 DM

DM 提供的卸载方式为全部卸载。在 Windows 操作系统下，可选择操作系统的“设置”菜单的“应用和功能”项，在打开的窗口中选择“达梦数据库”应用，点击“卸载”按钮进行卸载；也可以在 DM 安装目录下，找到卸载程序 uninstall.exe 来执行卸载。

卸载步骤:

步骤 1：运行卸载程序

程序将会弹出提示框确认是否卸载程序。点击“确定”进入卸载小结页面，点击“取消”退出卸载程序。如下图所示：

![图 2.17 卸载小结.png](https://eco.dameng.com/eco-file-server/file/eco/preview/2022102011465449M3T34G1SN7WCDSCI)

图2.17 确认卸载

步骤 2：卸载小结

显示 DM 的卸载目录信息。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.17-卸载小结.png)

图2.18 卸载小结

点击“卸载”，将弹出下图所示消息框确认是否删除 dm_svc.conf 配置文件。若点击“是”，则在卸载过程中将删除 dm_svc.conf 配置文件，开始卸载 DM；若点击“否”，则在卸载过程中不会删除 dm_svc.conf 配置文件，开始卸载 DM。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.18-确认是否删除dm_svc.conf配置文件.png)

图2.19 确认是否删除dm_svc.conf配置文件

步骤 3：卸载

显示卸载进度。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.19-卸载进度.png)

图2.20 卸载进度

点击“完成”按钮结束卸载。卸载程序不会删除安装目录下有用户数据的库文件以及安装 DM 后使用过程中产生的一些文件。用户可以根据需要手工删除这些内容。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.20-卸载完成.png)

图2.21 卸载完成

## 2.2 Linux（Unix）下 DM 的安装与卸载

### 2.2.1 安装前准备工作

用户在安装 DM 之前需要检查或修改操作系统的配置，以保证 DM 正确安装和运行。

标题及下文中提到的 Linux(Unix)，包括 Linux、AIX、HP-UNIX、Solaris 和 FreeBSD 操作系统。以下安装程序说明将以 Red Hat Enterprise Linux 6 for x86-64 系统为例，由于不同操作系统系统命令不尽相同，具体步骤及操作请以本机系统为准，具体细节可向系统管理员咨询。

#### 2.2.1.1 检查 Linux(Unix)系统信息

如果用户的 DM 软件安装包是经过数字签名的，请参照以下步骤进行操作，其他情况请忽略此步骤。

软件安装包的数字签名校验：

1.导入达梦公司的公钥，命令如下：

```
##gpg --import dm-pub-key
```

2.将达梦公司的公钥添加到绝对信任列表

```
#gpg --edit-key 武汉达梦数据库股份有限公司 trust
```

3.验证达梦安装包的数字签名

```
## gpg --verify dm.sign dm8_setup_xxx.iso
```

步骤 3 输出结果是“完好的签名”(“Good Signature”)则表示安装包文件完好无损。

用户在安装 DM 前，需要检查当前操作系统的相关信息，确认 DM 安装程序与当前操作系统匹配，以保证 DM 能够正确安装和运行。用户可以使用以下命令检查操作系统基本信息。如下图所示：

```
##获取系统位数

getconf LONG_BIT

##查询操作系统release信息

lsb_release -a

##查询系统信息

cat /etc/issue

##查询系统名称

uname -a
```

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.21-检查Linux(Unix)系统信息.png)

图2.22 检查Linux(Unix)系统信息

#### 2.2.1.2 创建安装用户

为了减少对操作系统的影响，用户不应该以 root 系统用户来安装和运行 DM。用户可以在安装之前为 DM 创建一个专用的系统用户。可参考以下示例创建系统用户和组(并指定用户 ID 和组 ID)，具体细节可向系统管理员咨询。

1.创建安装用户组 dinstall。

```
groupadd -g 12349 dinstall
```

2.创建安装用户 dmdba。

```
useradd -u 12345 -g dinstall -m -d /home/dmdba -s /bin/bash dmdba
```

3.初始化用户密码。

```
passwd dmdba
```

4.之后通过系统提示进行密码设置。

注意：创建安装系统用户完成后，安装手册之后的操作默认使用安装系统用户进行操作。

#### 2.2.1.3 Linux(Unix)下检查操作系统限制

在 Linux(Unix)系统中，因为 ulimit 命令的存在，会对程序使用操作系统资源进行限制。为了使 DM 能够正常运行，建议用户检查当前安装用户的 ulimit 参数。

运行 ulimit -a 进行查询。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.22-查看ulimit参数.png)

图2.23 查看ulimit参数

参数使用限制：

1.data seg size

```
data seg size (kbytes, -d)
```

建议用户设置为 1048576(即 1GB)以上或 unlimited(无限制)，此参数过小将导致数据库启动失败。

2. file size

```
file size(blocks, -f)
```

建议用户设置为 unlimited(无限制)，此参数过小将导致数据库安装或初始化失败。

3. open files

```
open files(-n)
```

建议用户设置为 65536 以上或 unlimited(无限制)。

4.virtual memory

```
virtual memory (kbytes, -v)
```

建议用户设置为 1048576(即 1GB)以上或 unlimited(无限制)，此参数过小将导致数据库启动失败。

如果用户需要为当前安装用户更改 ulimit 的资源限制，请修改文件/etc/security/limits.conf。

#### 2.2.1.4 检查系统内存与存储空间

1.检查内存

为了保证 DM 的正确安装和运行，要尽量保证操作系统至少 1GB 的可用内存(RAM)。如果可用内存过少，可能导致 DM 安装或启动失败。用户可以使用以下命令检查操作内存：

```
##获取内存总大小

grep MemTotal /proc/meminfo

##获取交换分区大小

grep SwapTotal /proc/meminfo

##获取内存使用详情

free
```

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.23-检查内存.png)

图2.24 检查内存

2.检查存储空间

  1. DM 完全安装需要 1GB 的存储空间，用户需要提前规划好安装目录，预留足够的存储空间。用户在 DM 安装前也应该为数据库实例预留足够的存储空间，规划好数据路径和备份路径。用户可使用以下命令检查存储空间:



```
##查询目录/mount_point/dir_name可用空间

df -h /mount_point/dir_name
```

  2. DM 安装程序在安装时将产生临时文件，安装过程中需要至少 2G 的临时空间，临时文件目录默认为**/tmp**。用户可以使用以下命令检查存储空间。如下图所示：



![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.24-检查存储空间.png)

图2.25 检查存储空间

如果/tmp 目录不能保证 1GB 的存储空间，用户可以扩展/tmp 目录存储空间或者通过设置环境变量 DM_INSTALL_TMPDIR 指定安装程序的临时目录。具体命令如下所示:

```
##以BASH为例:

mkdir -p /mount_point/dir_name

DM_INSTALL_TMPDIR=/mount_point/dir_name

export DM_INSTALL_TMPDIR
```

#### 2.2.1.5 设置 JAVA 环境

如果对安装程序和客户端运行的 JAVA 环境无特殊需求，可忽略此步骤。在运行安装程序之前，通过设置环境变量 DM_JAVA_HOME 指定特定的 JAVA 的目录，安装程序将使用此 JAVA 环境进行安装，且安装完成之后，客户端程序也将使用此 JAVA 环境。具体命令如下所示:

```
##以BASH为例:

DM_JAVA_HOME=/mount_point/jdk_home_dir

export DM_JAVA_HOME
```

### 2.2.2 安装 DM

用户应登录或切换到安装系统用户，进行以下安装步骤的操作(注：不建议使用 root 系统用户进行安装)。

将 DM 安装光盘放入光驱，然后加载(mount)光驱。一般可以通过执行下面的命令来加载光驱：

```
mount /dev/cdrom /mnt/cdrom
```

这里假定光驱对应的文件为/dev/cdrom 且目标路径/mnt/cdrom 已存在。

加载(mount)光驱后，在/mnt/cdrom 目录下存在 DMInstall.bin 文件，DMInstall.bin 文件就是 DM 的安装程序。在运行安装程序前，需要赋予 DMInstall.bin 文件执行权限。具体命令如下所示：

```
chmod 755 ./DMInstall.bin
```

#### 2.2.2.1 图形化安装

用户双击 DMInstall.bin 或执行以下命令将运行 DM 的图形化安装。

```
./DMInstall.bin
```

安装须知：

1)用户在进行图形化安装时，应当确认当前正处于图形化界面的运行环境，否则运行安装程序将报错。这种情况建议用户使用命令行安装 DM。

2)建议用户使用安装系统用户直接登录。如果用户在图形化界面中使用 su 命令切换至安装系统用户，可能导致启动图形化安装程序启动失败。具体情况请参考 [5.1 xhost 配置](https://eco.dameng.com/document/dm/zh-cn/pm/dm8-appendix.html#5.1%20xhost%20%E9%85%8D%E7%BD%AE)。

3)图形化安装过程中会在命令行打印安装信息。安装过程中，解压安装程序后，会对 GLIBC_VERSION 和硬件架构进行校验，并打印校验结果，下面介绍具体的校验结果信息。

GLIBC_VERSION 和硬件架构均校验成功时，打印信息如下：

```
GLIBC VERSION校验通过！
硬件架构校验通过！
```

若硬件架构不适配，则会报错并说明错误位置，打印信息如下：

```
GLIBC VERSION校验通过！
安装程序执行码硬件架构与当前平台硬件架构不适配！
//具体错误位置
./DMInstall.bin:行510: /tmp/DMInstall/source/bin/disql：无法执行二进制文件: 可执行文件格式错误
```

安装过程如下：

步骤 1：提示对话框

如果当前操作系统中已存在 DM，将弹出提示对话框。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.25-确认.jpg)

图2.26 确认

注意：若系统中已安装 DM，重新安装前，应完全卸载原来的 DM。并且在重新安装前，务必备份好数据。

步骤 2：选择语言和时区

请根据系统配置选择相应语言与时区，点击“确定”按钮继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.26-选择语言与时区.jpg)

图2.27 选择语言与时区

步骤 3：欢迎页面

点击“开始”按钮继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.27-欢迎界面.png)

图2.28 欢迎界面

步骤 4：许可证协议

在安装和使用 DM 之前，该安装程序需要用户阅读许可协议条款，用户如接受该协议，则选中“接受”，并点击“下一步”继续安装；用户若选中“不接受”，将无法进行安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.28-许可证协议.jpg)

图2.29 许可证协议

步骤 5：查看版本信息

用户可以查看 DM 服务器、客户端等各组件相应的版本信息。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.29-版本信息.jpg)

图2.30 版本信息

步骤 6：验证 Key 文件

用户点击“浏览”按钮，选取 Key 文件，安装程序将自动验证 Key 文件信息。如果是合法的 Key 文件且在有效期内，用户可以点击“下一步”继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.30-Key文件.jpg)

图2.31 Key文件

步骤 7：选择安装方式

DM 安装程序提供四种安装方式：“典型安装”、“服务器安装”、“客户端安装”和“自定义安装”，用户可根据实际情况灵活地选择。如下图所示：

典型安装包括：服务器、客户端、驱动、用户手册、数据库服务。

服务器安装包括：服务器、驱动、用户手册、数据库服务。

客户端安装包括：客户端、驱动、用户手册。

自定义安装包括：根据用户需要勾选组件，可以是服务器、客户端、驱动、用户手册、数据库服务中的任意组合。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.31-选择组件.jpg)

图2.32 选择组件

一般地，作为服务器端的机器只需选择“服务器安装”选项，特殊情况下，服务器端的机器也可以作为客户机使用，这时，机器必须安装相应的客户端软件。

步骤 8：选择安装目录

选择安装目录。如下图所示。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.32-选择安装位置.jpg)

图2.33 选择安装位置

DM 默认安装目录为$HOME/dmdbms(如果安装用户为 root 系统用户，则默认安装目录为/opt/dmdbms，但不建议使用 root 系统用户来安装 DM)，用户可以通过点击“浏览”按钮自定义安装目录。如果用户所指定的目录已经存在，则弹出如下图所示警告消息框提示用户该路径已经存在。若确定在指定路径下安装请点击“确定”，则该路径下已经存在的 DM 某些组件，将会被覆盖；否则点击“取消”，返回到上图所示界面，重新选择安装目录。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.33-确认安装目录.jpg)

图2.34 确认安装目录

说明：安装路径里允许字符的范围是小写字母(a-z)、大写字母(A-Z)、数字(0-9)、下划线(_)、空格( )和中文。

步骤 9：安装前小结

显示用户即将进行的安装的有关信息，例如产品名称、版本信息、安装类型、安装目录、可用空间、可用内存等信息，用户检查无误后点击“安装”按钮，开始拷贝安装的软件。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.34-安装前小结信息.jpg)

图2.35 安装前小结信息

步骤 10：安装

安装。如下图所示。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.35-安装界面.jpg)

图2.36 安装界面

注意：当安装进度完成时将会弹出对话框，提示使用 root 系统用户执行相关命令。用户可根据对话框的说明完成相关操作，之后可关闭此对话框，点击“完成”按钮结束安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.36-执行配置脚本.jpg)

图2.37 执行配置脚本

步骤 11：初始化数据库

如用户在选择安装组件时选中服务器组件，DM 安装过程结束时，将会提示是否初始化数据库，如下图所示。若用户未安装服务器组件，安装完成后，点击“完成”将直接退出，点击“取消”将完成安装，关闭对话框。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.37-初始化数据库.jpg)

图2.38 初始化数据库

若用户选中创建数据库选项，点击“初始化”将弹出数据库配置工具。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.38-达梦数据库配置助手.jpg)

图2.39 达梦数据库配置助手

详细初始化步骤请参考[数据库配置工具使用说明](/document/dm/zh-cn/pm/install-uninstall)。

#### 2.2.2.2 命令行安装

在现实中，许多 Linux(Unix)操作系统上是没有图形化界面的，为了使 DM 能够在这些操作系统上顺利安装，DM 提供了命令行的安装方式。在终端进入到安装程序所在文件夹，执行以下命令进行命令行安装：

```
./DMInstall.bin -i
```

安装过程如下：

步骤 1：选择安装语言

请根据系统配置选择相应语言，输入选项，回车进行下一步。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.39-选择安装语言.png)

图2.40 选择安装语言

选择好安装语言，进行解压安装程序，解压后会对 GLIBC_VERSION 和硬件架构进行校验，并打印校验结果，校验结果信息的内容与图形化安装一致（可查看 [2.2.2.1 图形化安装](https://eco.dameng.com/document/dm/zh-cn/pm/install-uninstall.html#2.2.2.1%20%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%AE%89%E8%A3%85)），而且此时还会打印 ulimit 参数信息与建议。

![图 2.39-1 打印校验信息与 ulimit 参数信息.png](https://eco.dameng.com/eco-file-server/file/eco/preview/20240924161739M427ZXPNC1B80I2GAK)

图2.41 打印校验信息与ulimit参数信息

如果当前操作系统中已存在 DM，将在终端弹出提示，输入选项：继续，将进行下一步的命令行安装，否则退出命令行安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.40-是否继续.png)

图2.42 是否继续

注意：若操作系统中已安装 DM，重新安装前，应完全卸载已存在的 DM。并且在重新安装前，务必备份好数据。

步骤 2：验证 Key 文件

用户可以选择是否输入 Key 文件路径。不输入则进入下一步安装，输入 Key 文件路径，安装程序将显示 Key 文件的详细信息，如果是合法的 Key 文件且在有效期内，用户可以继续安装。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.41-验证Key文件.png)

图2.43 验证Key文件

步骤 3：输入时区

用户可以选择 DM 的时区信息。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.42-输入时区.png)

图2.44 输入时区

步骤 4：选择安装类型

命令行安装与图形化安装的选择的安装类型是一样。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.43-选择安装类型.png)

图2.45 选择安装类型

用户选择安装类型需要手动输入，默认是典型安装。如果用户选择自定义安装，将打印全部安装组件信息。用户通过命令行窗口输入要安装的组件序号，选择多个安装组件时需要使用空格进行间隔。输入完需要安装的组件序号后回车，将打印安装选择组件所需要的存储空间大小。

步骤 5：选择安装路径

用户可以输入 DM 的安装路径，不输入则使用默认路径，默认值为$HOME/dmdbms(如果安装用户为 root，则默认安装目录为/opt/dmdbms，但不建议使用 root 系统用户来安装 DM)。
如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.44-选择安装路径.png)

图2.46 选择安装路径

安装程序将打印当前安装路径的可用空间，如果空间不足，用户需重新选择安装路径。如果当前安装路径可用空间足够，用户需进行确认。不确认，则重新选择安装路径，确认，则进入下一步骤。

说明：安装路径里允许字符的范围是小写字母(a-z)、大写字母(A-Z)、数字(0-9)、下划线(_)、空格( )和中文。

步骤 6：安装小结

安装程序将打印用户之前输入的部分安装信息。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.45-安装小结.png)

图2.47 安装小结

用户对安装信息进行确认。不确认，则退出安装程序，确认，进行 DM 的安装。

步骤 7：安装

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.46-安装过程.png)

图2.48 安装过程

注意 ： 安装完成后，终端提示“请以 root 系统用户执行命令”。由于使用非 root 系统用户进行安装，所以部分安装步骤没有相应的系统权限，需要用户手动执行相关命令。用户可根据提示完成相关操作。

步骤 8：初始化数据库与注册服务

安装结束后，还需要初始化数据库并注册相关服务才能正式运行达梦数据库，具体可参考《DM8_dminit 使用手册》和《DM8_Linux 服务脚本使用手册》。

需要注意的是，达梦提供的各个服务基本都依赖于网络和存储才能正常启动，因此当启动达梦服务时若网络和存储没有就绪可能会失败，此时可等网络和存储就绪后再次手动启动达梦相关服务，或修改达梦相关服务脚本中的优先级和依赖关系。

#### 2.2.2.3 静默安装

在某些特殊应用场景，用户可能需要非交互式的、通过配置文件进行 DM 的安装，这种情况我们可以采用以下静默安装的方式。在终端进入到安装程序所在文件夹，执行以下命令。如下图所示。

```
./DMInstall.bin -q 配置文件全路径
```

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.47-静默安装.png)

图2.49 静默安装

静默安装配置文件相关说明详见 [5.2 静默安装配置文件模板](https://eco.dameng.com/document/dm/zh-cn/pm/dm8-appendix.html#5.2%20%E9%9D%99%E9%BB%98%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A8%A1%E6%9D%BF)。

### 2.2.3 卸载 DM

DM 提供的卸载程序为全部卸载。Linux 提供两种卸载方式，一种是图形化卸载方式，另一种是命令行卸载方式。

#### 2.2.3.1 图形化卸载

用户在 DM 安装目录下，找到卸载程序 uninstall.sh 来执行卸载。用户执行以下命令启动图形化卸载程序。

```
##进入DM安装目录

cd /DM_INSTALL_PATH

##执行卸载脚本

./uninstall.sh
```

卸载步骤:

步骤 1：运行卸载程序

程序将会弹出提示框确认是否卸载程序。点击“确定”进入卸载小结页面，点击“取消”退出卸载程序。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.48-确认卸载.png)

图2.50 确认卸载

步骤 2：卸载小结

显示 DM 的卸载目录信息。点击“卸载”，开始卸载 DM。如下图所示。

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual//图2.49-准备卸载.jpg)

图2.51 准备卸载

步骤 3：卸载

显示卸载进度。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.50-卸载.jpg)

图2.52 卸载

在 Linux(Unix)系统下，使用非 root 用户卸载完成时，将会弹出对话框，提示使用 root 执行相关命令，用户可根据对话框的说明完成相关操作，之后可关闭此对话框。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.51-执行配置脚本.jpg)

图2.53 执行配置脚本

点击“完成”按钮结束卸载。卸载程序不会删除安装目录下有用户数据的库文件以及安装 DM 后使用过程中产生的一些文件。用户可以根据需要手工删除这些内容。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.52-卸载完成.jpg)

图2.54 卸载完成

#### 2.2.3.2 命令行卸载

用户在 DM 安装目录下，找到卸载程序 uninstall.sh 来执行卸载。用户执行以下命令启动命令行卸载程序。

```
##进入DM安装目录

cd /DM_INSTALL_PATH

##执行卸载脚本命令行卸载需要添加参数-i

./uninstall.sh -i
```

卸载步骤:

步骤 1：运行卸载程序

终端窗口将提示确认是否卸载程序，输入“y/Y”开始卸载 DM，输入“n/N”退出卸载程序。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.53-运行卸载程序.png)

图2.55 运行卸载程序

步骤 2：卸载

显示卸载进度。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.54-卸载.png)

图2.56 卸载

在 Linux(Unix)系统下，使用非 root 用户卸载完成时，终端提示“请以 root 系统用户执行命令”。用户需要手动执行相关命令。如下图所示：

![删除目录](https://download.dameng.com/eco/docs/asset/pm/dm-installation-manual/图2.55-提示使用root用户执行命令.png)

图2.57 提示使用root用户执行命令

## 2.3 安装日志

安装的过程中，会产生两种日志：

一是 install_ant.log，记录安装过程中的文件拷贝信息。日志格式为：逐条记录从安装软件中拷贝到安装目录下的文件。

二是 install.log，记录安装过程中的安装模块、注册服务、卸载等信息。日志格式为：时间 + 日志类型（INFO/WARN/ERROR/FATAL）+ 日志内容。

例 1 下面展示一段 install_ant.log 日志。

```
Build sequence for target(s) `default' is [jdk, default]

Complete build sequence is [jdk, default, ent.default, manual, ent.postinstall, clt, postinstall, gui, client, ent.drivers, ent.server, ent.clt, install, drivers, server, ent.service, ent.manual, ent.jdk, ent.client, ent.gui, service, ]

fileset: Setup scanner in dir C:\Users\dameng\Downloads\dm8_20220908_x86_win_64_ent_8.1.2.159\source\jdk with patternSet{ includes: [] excludes: [] }

Copying 201 files to d:\dmdbms\jdk

Copying C:\Users\dameng\Downloads\dm8_20220908_x86_win_64_ent_8.1.2.159\source\jdk\ASSEMBLY_EXCEPTION to d:\dmdbms\jdk\ASSEMBLY_EXCEPTION

Copying C:\Users\dameng\Downloads\dm8_20220908_x86_win_64_ent_8.1.2.159\source\jdk\LICENSE to d:\dmdbms\jdk\LICENSE

Copying C:\Users\dameng\Downloads\dm8_20220908_x86_win_64_ent_8.1.2.159\source\jdk\THIRD_PARTY_README to d:\dmdbms\jdk\THIRD_PARTY_README

……
```

例 2 下面展示一段 install.log 日志。

```
2022-09-14 14:55:30 

[INFO] 安装达梦数据库...

2022-09-14 14:55:30 

[INFO] 安装 基础 模块...

2022-09-14 14:55:31 

[INFO] 安装 服务器 模块...

2022-09-14 14:55:31 

[INFO] 安装 客户端 模块...

2022-09-14 14:55:34 

[INFO] 安装 驱动 模块...

2022-09-14 14:55:35 

[INFO] 安装 手册 模块...

2022-09-14 14:55:35 

[INFO] 安装 服务 模块...

2022-09-14 14:55:35 

[INFO] 注册ODBC完成。
```
