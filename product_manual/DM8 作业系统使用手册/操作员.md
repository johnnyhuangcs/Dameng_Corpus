

# 操作员

创建、修改和删除操作员可以通过以下两种方式来实现。一是通过系统过程来实现；二是通过图形化客户端 MANAGER 管理工具实现。用户选择其中的一种即可。

## 3.1 通过系统过程实现

分别用 SP_CREATE_OPERATOR、SP_ALTER_OPERATOR 和 SP_DROP_OPERATOR 三个过程来完成操作员的创建、修改和删除。

### 3.1.1 创建操作员

在数据库中创建了前述作业管理表后，就可以进行作业的配置了。由于在创建一个作业时必须要指定操作员，所以需要创建一个操作员。

创建操作员可以直接通过调用系统过程来实现，过程名为 SP_CREATE_OPERATOR，所创建的操作员信息都会存储于表 SYSOPERATORS 中。

语法如下：

```
SP_CREATE_OPERATOR (
	opr_name 		varchar(128),
	enabled 		int,
	emailaddr 		varchar(128),
	netsend_ip 		varchar(128)
)
```

参数详解

  * OPR_NAME



操作员名称。必须是有效的标识符，同时不能是 DM 关键字。不能有同名操作员，如果创建同名操作员，系统会报错。

  * ENABLED



是否启用这个操作员。1：是；0：否。

  * EMAILADDR



操作员的 EMAIL 地址。

  * NETSEND_IP



操作员的 IP 地址（用于网络发送）。在创建时必须指定合法的 IP 地址，否则报错。

例  创建一个名为 TOM 的操作员。

```
SP_CREATE_OPERATOR('TOM', 1, 'tom\@dameng.shanghai', '192.168.0.38');
```

### 3.1.2 修改操作员

如果 DBA 希望修改某一个操作员的某些信息，DM 也提供了相应的系统过程，函数名为 SP_ALTER_OPERATOR。

语法如下：

```
SP_ALTER_OPERATOR (
	opr_name 		varchar(128),
	enabled 		int,
	emailaddr 		varchar(128),
	netsend_ip 		varchar(128)
)
```

参数详解

  * OPR_NAME



不可修改参数。操作员名称，指定要修改哪一个操作员，如果这个操作员不存在，系统会报错。

  * ENABLED



可修改参数。表示是否启用这个操作员。1：是；0：否。例如，将这个值修改为 0，表明将这个操作员修改为不可用。

  * EMAILADDR



可修改参数。表示修改后操作员的 EMAIL 地址。

  * NETSEND_IP



可修改参数。修改后操作员 IP 地址（主要用于网络发送），在修改时指定的 IP 地址必须是合法的，不然会报错。

> **说明**
>
> 对于可修改参数：  
> 如果需要修改则传入新的参数值；  
> 如果不需要修改则传入原来的值即可。



例  修改操作员 TOM 的信息，修改了 TOM 的 IP 地址，并将 TOM 置为不可用。

```
SP_ALTER_OPERATOR('TOM', 0, 'tom\@dameng.shanghai', '192.168.0.38');
```

### 3.1.3 删除操作员

可以通过调用系统过程来删除一个操作员，过程名为 SP_DROP_OPERATOR。

语法如下：

```
SP_DROP_OPERATOR (
	opr_name varchar(128)
)
```

参数详解

  * OPR_NAME



操作员名称。如果指定的操作员不存在，则系统会报操作员不存在的错误；如果指定的操作员存在，则会从表 SYSOPERATORS 中将这条记录删除，同时将所有这个操作员与警报的关联关系从表 SYSALERTNOTIFICATIONS 中删除，但是不会删除指定该操作员的作业。

例  删除名为 TOM 的操作员。

```
SP_DROP_OPERATOR('TOM');
```

## 3.2 通过图形化客户端实现

可以通过图形化客户端 MANAGER 工具实现操作员的创建、修改和删除。

点击代理中的操作员。可以看到新建操作员、设置过滤、清除过滤和刷新按钮。如下所示：

![新建操作员界面](https://download.dameng.com/eco/docs/asset/pm/dm8-operation/图3.1-新建操作员界面.png)

图3.1 新建操作员界面

### 3.2.1 创建操作员

选中新建操作员。会出现如下界面：

常规页面，用来添加操作员。

![图 3.2 新建操作员-常规界面.png](https://eco.dameng.com/eco-file-server/file/eco/preview/20240816111339XAFZK9TKKTV636EW94)

图3.2 新建操作员-常规界面

DDL 页面，用来显示创建操作员的 SQL 语句。还可以保存 SQL 脚本到指定文件中。如下所示：

![图 3.3 新建操作员-DDL 界面.png](https://eco.dameng.com/eco-file-server/file/eco/preview/20240816111346P80F5AY227Q74XHK85)

图3.3 新建操作员-DDL界面

### 3.2.2 修改操作员

选中要修改的操作员。如下所示：

![修改操作员界面](https://download.dameng.com/eco/docs/asset/pm/dm8-operation/图3.4-修改操作员界面.png)

图3.4 修改操作员界面

点击修改，即可出现如下界面。例如，将 TOM 的邮箱修改为 tom@dameng.shanghai。如下所示：

![图 3.5 修改操作员-常规界面.png](https://eco.dameng.com/eco-file-server/file/eco/preview/20240816111400SXD295DDTYR6Y8KQXT)

图3.5 修改操作员-常规界面

### 3.2.3 设置过滤、清除过滤

当操作员过多时，可以通过设置过滤条件来选择符合条件的操作员。如下所示：

![操作员-设置过滤界面](https://download.dameng.com/eco/docs/asset/pm/dm8-operation/图3.6-操作员-设置过滤界面.png)

图3.6 操作员-设置过滤界面

点击操作员，选中设置过滤，会出现如下界面。其中，过滤条件有包含、不包含和等于三种。例如，设置过滤条件为名称中包含 TOM 的操作员。如下所示：

![图 3.7 操作员-对象过滤界面.png](https://eco.dameng.com/eco-file-server/file/eco/preview/202408161114104XB4PSC250W2VZ73LO)

图3.7 操作员-对象过滤界面

过滤条件使用完后，想恢复原状，看到所有操作员，此时需要清除过滤条件，选中清除过滤即可。

### 3.2.4 删除操作员

选中要删除的操作员名称，点击删除即可。如下所示：

![删除操作员界面](https://download.dameng.com/eco/docs/asset/pm/dm8-operation/图3.8-删除操作员界面.png)

图3.8 删除操作员界面
